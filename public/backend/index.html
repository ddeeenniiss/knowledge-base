<!-- Formular mit AJAX. Kann nur auf PHP Server abgesendet werden -->

<h2 style="text-align: center; font-family: sans-serif;">Formular mit AJAX</h2>

<form id="ajaxForm" style="max-width: 400px; margin: 40px auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; font-family: sans-serif;">
  <label for="ajax_firstname" style="display: block; margin-top: 12px; font-weight: 600;">Vorname</label>
  <input type="text" id="ajax_firstname" name="firstname" required style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px;">

  <label for="ajax_lastname" style="display: block; margin-top: 12px; font-weight: 600;">Nachname</label>
  <input type="text" id="ajax_lastname" name="lastname" required style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px;">

  <label for="ajax_address" style="display: block; margin-top: 12px; font-weight: 600;">Adresse</label>
  <input type="text" id="ajax_address" name="address" required style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px;">

  <label for="ajax_email" style="display: block; margin-top: 12px; font-weight: 600;">E-Mail</label>
  <input type="email" id="ajax_email" name="email" required style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px;">

  <label for="ajax_phone" style="display: block; margin-top: 12px; font-weight: 600;">Telefon</label>
  <input type="tel" id="ajax_phone" name="phone" style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px;">

  <label for="ajax_gender" style="display: block; margin-top: 12px; font-weight: 600;">Geschlecht</label>
  <select id="ajax_gender" name="gender" required style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px;">
    <option value="">Bitte auswählen</option>
    <option value="male">Männlich</option>
    <option value="female">Weiblich</option>
    <option value="diverse">Divers</option>
  </select>

  <label for="ajax_message" style="display: block; margin-top: 12px; font-weight: 600;">Nachricht</label>
  <textarea id="ajax_message" name="message" required style="width: 100%; margin-top: 6px; padding: 8px; font-size: 14px; min-height: 100px; background: #eee; border-radius: 5px;"></textarea>

  <button type="submit" style="width: 100%; margin-top: 20px; padding: 8px; font-size: 14px; cursor: pointer;">Absenden</button>
</form>

<div id="formMessage" style="margin-top: 1rem; font-family: sans-serif;"></div>

<script>
const form = document.getElementById('ajaxForm');
const messageDiv = document.getElementById('formMessage');
const envWarning = document.getElementById('envWarning');
const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

if (!isLocalhost) {
  envWarning.innerHTML = '<p style="color: orange; font-weight: bold;">⚠️ Formulare funktionieren nur auf localhost (PHP wird auf GitHub Pages nicht ausgeführt)</p>';
  form.style.display = 'none';
}

form.addEventListener('submit', async (e) => {
  e.preventDefault();
  const formData = new FormData(form);

  try {
    const response = await fetch('http://localhost:8000/formular-ajax.php', {
      method: 'POST',
      body: formData
    });

    const text = await response.text();

    if (text.includes("Nachricht erfolgreich gesendet")) {
      messageDiv.style.color = "green";
      messageDiv.textContent = "Danke! Ihre Nachricht wurde erfolgreich versendet.";
      form.reset();
    } else {
      messageDiv.style.color = "red";
      messageDiv.textContent = "Fehler beim Senden: " + text;
    }
  } catch (err) {
    messageDiv.style.color = "red";
    messageDiv.textContent = "Fehler beim Senden: " + err;
  }
});
</script>